@model IEnumerable<Hotel.ViewModels.ListaAlquilerFrontEnd>

@{
    ViewData["Title"] = "Lista Alquiler";
    decimal total = 0;
    string color()
    {
        if (total >= 2000)
        {
            return "table-success";
        }
        else if (total <= 500)
        {
            return "table-danger";
        }
        else
        {
            return "table-warning";
        }
    }
}
<br />
<h1>Listado de Alquiler</h1>

<form method="get" action="@Url.Action("Index")">
    <div class="row g-3 align-items-end">

        <div class="col-md-3">
            <label for="fecha1" class="form-label">Desde</label>
            <input type="date" id="fecha1" name="fecha1" class="form-control" />
        </div>

        <div class="col-md-3">
            <label for="fecha2" class="form-label">Hasta</label>
            <input type="date" id="fecha2" name="fecha2" class="form-control" />
        </div>

        <div class="col-md-2">
            <button type="submit" class="btn btn-primary w-100">
                Buscar
            </button>
        </div>

        <div class="col-md-2">
            <a class="btn btn-danger w-100"
               href="@Url.Action("ExportarPDF", new { fecha1 = ViewBag.Fecha1, fecha2 = ViewBag.Fecha2 })">
                Descargar PDF
            </a>
        </div>

    </div>
</form>

<br />
<table class="table table-striped">
    <thead>
        <tr>
            <th>Habitación</th>
            <th>Cliente</th>
            <th>N° Documento</th>
            <th>Días</th>
            <th>Precio</th>
            <th>Fecha Entrada</th>
            <th>Fecha Salida</th>
            <th>Total</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var alquiler in Model)
        {
            <tr>
                <td>@alquiler.numHab</td>
                <td>@alquiler.nombre</td>
                <td>@alquiler.documento</td>
                <td>@alquiler.dias</td>
                <td>@alquiler.precio.ToString("C")</td>
                <td>@alquiler.fechaEntrada?.ToString("dd/MM/yyyy")</td>
                <td>@alquiler.fechaSalida?.ToString("dd/MM/yyyy")</td>
                <td>@alquiler.total.ToString("C")</td>
            </tr>
            total += alquiler.total;
        }
            <tr class="@color()">
                <td colspan="7">Sumatoria total</td>
                <td>@total.ToString("c")</td>
            </tr>
    </tbody>
</table>
@if (!ViewData.ModelState.IsValid)
{
    <div class="alert alert-danger">
        @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
        {
            <p>@error.ErrorMessage</p>
        }
    </div>
}
